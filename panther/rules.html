<!DOCTYPE html>
<html lang="en-US"> <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>rules - Docs for Panther</title> <link rel="shortcut icon" href="/sample-docs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/sample-docs/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/sample-docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/sample-docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>rules | Docs for Panther</title> <meta name="generator" content="Jekyll v3.9.0"> <meta property="og:title" content="rules"> <meta property="og:locale" content="en_US"> <link rel="canonical" href="https://vinceoa.github.io/sample-docs/panther/rules"> <meta property="og:url" content="https://vinceoa.github.io/sample-docs/panther/rules"> <meta property="og:site_name" content="Docs for Panther"> <meta name="twitter:card" content="summary"> <meta property="twitter:title" content="rules"> <script type="application/ld+json"> {"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://vinceoa.github.io/sample-docs/img/PANTHER-LOGO_TRANSPARENT_BG.png"}},"headline":"rules","@type":"WebPage","url":"https://vinceoa.github.io/sample-docs/panther/rules","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <meta name="openans.product" content="Panther"> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewbox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewbox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewbox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewbox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewbox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://vinceoa.github.io/sample-docs/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewbox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list">
<li class="nav-list-item"><a href="https://vinceoa.github.io/sample-docs/" class="nav-list-link">Home</a></li>
<li class="nav-list-item"><a href="https://vinceoa.github.io/sample-docs/getting-started" class="nav-list-link">Getting Started</a></li>
<li class="nav-list-item"><a href="https://vinceoa.github.io/sample-docs/panther/api" class="nav-list-link">api</a></li>
<li class="nav-list-item"><a href="https://vinceoa.github.io/sample-docs/panther/admin" class="nav-list-link">admin</a></li>
<li class="nav-list-item"><a href="https://vinceoa.github.io/sample-docs/panther/views" class="nav-list-link">views</a></li>
<li class="nav-list-item active"><a href="https://vinceoa.github.io/sample-docs/panther/rules" class="nav-list-link active">rules</a></li>
<li class="nav-list-item"><a href="https://vinceoa.github.io/sample-docs/panther/console" class="nav-list-link">console</a></li>
<li class="nav-list-item"><a href="https://vinceoa.github.io/sample-docs/panther/about" class="nav-list-link">about</a></li>
<li class="nav-list-item"><a href="https://vinceoa.github.io/sample-docs/panther/help" class="nav-list-link">help</a></li>
<li class="nav-list-item"><a href="https://vinceoa.github.io/sample-docs/panther/dashboard" class="nav-list-link">dashboard</a></li>
</ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Docs for Panther" aria-label="Search Docs for Panther" autocomplete="off"> <label for="search-input" class="search-label"><svg viewbox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h2 id="overview"> <a href="#overview" class="anchor-heading" aria-labelledby="overview"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overview </h2> <p>Rules control how log messages are turned into events. They can be used to discard, de-duplicate or modify the events that appear in the Panther console.</p> <p>Events are received from an external source, processed by user defined rules, and finally stored on the Panther server.</p> <p><img src="/sample-docs/panther/rules/media/panther-flow.svg" alt=""></p> <h3 id="processing-order"> <a href="#processing-order" class="anchor-heading" aria-labelledby="processing-order"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Processing order </h3> <p><img src="/sample-docs/panther/rules/media/RuleFlow.svg" alt=""></p> <p>The set of <a href="#syslog-mappings">Syslog Mappings</a> are processed first, followed by the <a href="#global-rules">Global Rules</a> and, finally, any optional <a href="#group-rules">Groups Rules</a>.</p> <h2 id="global-rules"> <a href="#global-rules" class="anchor-heading" aria-labelledby="global-rules"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Global Rules </h2> <p>Global rules are applied to every event that is parsed into Panther. These would be common rules intended to apply to most if not every group.</p> <p>An example would be a global rule to discard any events that are sent in due to the registry file being in use by another application or service.</p> <p>To implement this example:</p> <ol> <li> <p>Create a new rule <img src="/sample-docs/panther/rules/media/CreateGlobalRule7.png" alt=""></p> </li> <li> <p>Enter a name for the rule and choose a selector from the drop down menu. In this case, use <code class="language-plaintext highlighter-rouge">match</code> to check for a string in the summary of the event.</p> </li> </ol> <p><img src="/sample-docs/panther/rules/media/CreateGlobalRule4.png" alt=""></p> <ol> <li> <p>Select a field, in this case the summary field of the log event.</p> </li> <li> <p>Enter the string to match the field with in the summary. In this case, the message is <code class="language-plaintext highlighter-rouge">/detected your registry/</code>.</p> </li> <li> <p>The action to select is to delete the event log from the console. <img src="/sample-docs/panther/rules/media/CreateGlobalRule6.png" alt=""></p> </li> <li> <p>Save the new rule and click deploy to forward the changes to the server. <img src="/sample-docs/panther/rules/media/CreateGlobalRule9.png" alt=""></p> </li> </ol> <h2 id="group-rules"> <a href="#group-rules" class="anchor-heading" aria-labelledby="group-rules"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Group Rules </h2> <p>Group rules are used to sort the event logs into different groups, based on user discretion.</p> <p>An example of this would be splitting the events based on the service type, such as web service or OS. A “web service” group could handle events related to Apache, such as downtime for example, and an “OS” group could handle events such as system crashes. Sorting the event logs into groups such as these can help maximize efficiency by sending them to the relevant teams.</p> <p>To create a new group rule:</p> <ol> <li> <p>Create a new group <img src="/sample-docs/panther/rules/media/CreateGroupRule1.png" alt=""></p> </li> <li> <p>Enter the name of the group you want to make. In this case there are two groups – one named Operating System and one named Apache Web Service. <img src="/sample-docs/panther/rules/media/CreateGroupRule2.png" alt=""></p> </li> <li> <p>To match any event log with this group, set a rule in the group selector. In this case, the rule is going to check the tag of the event log for the string <code class="language-plaintext highlighter-rouge">os</code>. Once this match has been found, it will run through the rules in the group one by one against the event log entry, carrying out any processing required. To do this, click on the pencil to open up the group selector. <img src="/sample-docs/panther/rules/media/GroupSelector.png" alt=""></p> </li> <li> <p>Create a rule to match the tag field with the word <code class="language-plaintext highlighter-rouge">os</code>, and save it. <img src="/sample-docs/panther/rules/media/tagos.png" alt=""></p> </li> <li> <p>The new group selector can now match event logs containing the <code class="language-plaintext highlighter-rouge">os</code> tag against any rules in the group. To create a new rule for the group, click on the down arrow for it and select ‘Create a rule for…’ <img src="/sample-docs/panther/rules/media/CreateGroupRule33.png" alt=""></p> </li> <li> <p>This section is very similar to the <code class="language-plaintext highlighter-rouge">Global Rule</code> section. In this example, create a rule to log and group any failed <code class="language-plaintext highlighter-rouge">su</code> authentication events.</p> </li> </ol> <p><img src="/sample-docs/panther/rules/media/CreateGroupRule444.png" alt=""></p> <p>This rule is sending any event log that contains the string <code class="language-plaintext highlighter-rouge">FAILED su for .*</code> to the Operating System group and setting the severity to 3.</p> <ol> <li>Click <code class="language-plaintext highlighter-rouge">Save</code> and enable the deployment to the server.</li> </ol> <p><img src="/sample-docs/panther/rules/media/CreateGroupRule5.png" alt=""></p> <p>An example of this group rule being used is shown in the <a href="/api/README#example">API</a> section.</p> <h2 id="schedules"> <a href="#schedules" class="anchor-heading" aria-labelledby="schedules"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Schedules </h2> <p>Schedules can be used to specify specific times of the week, enabling Rules to only match under those conditions.</p> <p><img src="/sample-docs/panther/rules/media/Schedules.png" alt=""></p> <p>The <code class="language-plaintext highlighter-rouge">Name</code> is used to identify the schedule when editing Rules or Groups. It must be unique.</p> <p><code class="language-plaintext highlighter-rouge">Start</code> and <code class="language-plaintext highlighter-rouge">End</code> specify a time range in the format of <code class="language-plaintext highlighter-rouge">HH:MM</code>. If the <code class="language-plaintext highlighter-rouge">Start</code> time is after the <code class="language-plaintext highlighter-rouge">End</code> time then the following conditions shall match:</p> <ul> <li>From midnight to the <code class="language-plaintext highlighter-rouge">End</code> time</li> <li>From the <code class="language-plaintext highlighter-rouge">Start</code> time till midnight</li> </ul> <p>Days of the week can be chosen with the checkboxes</p> <ul> <li>
<em>S</em>unday</li> <li>
<em>M</em>onday</li> <li>
<em>T</em>uesday</li> <li>
<em>W</em>ednesday</li> <li>
<em>T</em>hursday</li> <li>
<em>F</em>riday</li> <li>
<em>S</em>aturday</li> </ul> <h2 id="syslog-mappings"> <a href="#syslog-mappings" class="anchor-heading" aria-labelledby="syslog-mappings"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Syslog Mappings </h2> <p>Syslog message fields need to be mapped to event console fields. These fields will then be available for matching in rules processing.</p> <h3 id="default-event-identifier"> <a href="#default-event-identifier" class="anchor-heading" aria-labelledby="default-event-identifier"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Default Event Identifier </h3> <p>The event’s <code class="language-plaintext highlighter-rouge">identifier</code> field uniquely identifies an event in the console.</p> <p>By default this is created by combining the node, severity, tag and summary fields: <code class="language-plaintext highlighter-rouge">{node}:{severity}:{tag}:{summary}</code>.</p> <p>Any events with a matching identifier will be grouped together, and the corresponding event <code class="language-plaintext highlighter-rouge">tally</code> will increase by 1.</p> <p>If no matching event identifier is found, then a new event is created.</p> <p>Timestamps are also stored for each event.</p> <p>Please note that when events are deduplicated via the <code class="language-plaintext highlighter-rouge">identifier</code> field, some information may be lost. For example, the PID of a process can change regularly, but is not included in the identifier by default, so multiple PIDs may aggregate into a single event.</p> <h3 id="severity-mapping"> <a href="#severity-mapping" class="anchor-heading" aria-labelledby="severity-mapping"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Severity Mapping </h3> <p>Syslog logging levels need to be mapped to event console severities as there is not a one to one relationship between them, and the scale is also inverted.</p> <p>Syslog levels are defined from 7 (debug) to 0 (emergency).</p> <p><img src="/sample-docs/panther/rules/media/severities.png" alt=""></p> <p>Event console severities are from 5 (critical) to 0 (clear).</p> <p>By default, events with severity 0 will be periodically removed from the list of event logs in the console.</p> <h3 id="field-transform"> <a href="#field-transform" class="anchor-heading" aria-labelledby="field-transform"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Field Transform </h3> <p>The transforms allow pre-defined functions to be applied to event console fields before rules processing takes place.</p> <p>Currently, <code class="language-plaintext highlighter-rouge">#[code lower_case]</code> is the only transform supported and by default it is applied to the <code class="language-plaintext highlighter-rouge">node</code> field, so that case checking is not necessary.</p> <p>If you have an idea for a transform you would like added, please let us know. TODO - really?</p> <h3 id="agent-rules"> <a href="#agent-rules" class="anchor-heading" aria-labelledby="agent-rules"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Agent Rules </h3> <h2 id="http"> <a href="#http" class="anchor-heading" aria-labelledby="http"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> HTTP </h2> <p>TODO</p> <h2 id="details"> <a href="#details" class="anchor-heading" aria-labelledby="details"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Details </h2> <p>Each rule definition is stored in yaml file.</p> <p>A basic rule has a <code class="language-plaintext highlighter-rouge">name</code> followed by a <em>Select</em> verb, such as <code class="language-plaintext highlighter-rouge">match</code>, and an <em>Action</em> verb, such as <code class="language-plaintext highlighter-rouge">discard</code>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  name: 'Rule name'
  match:
    some_field: value
  discard: true
</code></pre></div></div> <p>Multiple <em>Select</em>s are interpreted as logical “and” operations. This example is equivalent to “<em>Select</em> WHERE <code class="language-plaintext highlighter-rouge">some_field</code> <strong>matches</strong> the regular expression <code class="language-plaintext highlighter-rouge">/value/</code> AND where <code class="language-plaintext highlighter-rouge">other_field</code> <strong>equals</strong> <code class="language-plaintext highlighter-rouge">value</code>”:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  match:
    some_field: !!js/regexp /value/
  equals:
    other_field: value
</code></pre></div></div> <p>Multiple <em>Actions</em> can be specified too:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  discard: true
  stop: true
</code></pre></div></div> <p>A <em>RuleSet</em>, which groups the rules into logical areas, is made up of an array of <em>Rules</em>. These are processed in order, until the last rule is found or a <code class="language-plaintext highlighter-rouge">stop</code> or <code class="language-plaintext highlighter-rouge">stop_ruleset</code> action is encountered:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  - name: 'Rule name'
    match:
      some_field: value
    set:
      new_field: 17

  - name: 'No junk'
    equals:
      my_field: 'linux'
    set:
      that_field: 'Torvalds'
</code></pre></div></div> <p>There are multiple <em>RuleSets</em> used during processing. The <em>Global</em> <em>RuleSet</em> is processed first, followed by any <em>Group</em> rules. Only one group will be matched, based on the <em>Select</em> verbs, and its rules then processed.</p> <p><em>Discard</em> and <em>Dedupe</em> are shortcuts for what end up as rules that are placed before the rest of the <em>RuleSet</em>.</p> <h3 id="rule-order"> <a href="#rule-order" class="anchor-heading" aria-labelledby="rule-order"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rule Order </h3> <p>Rules are applied in the following order:</p> <ol> <li>Syslog mapping</li> <li>Global discards</li> <li>Global de-duplication</li> <li>Global rules, in order</li> <li>Grouping, and the group rules. (group_order: if required? TODO - check) <ol> <li>discard_first</li> <li>dedupe</li> <li>rules</li> <li>discard_last</li> </ol> </li> <li>Discards that rely on other mappings</li> </ol> <h3 id="shortcut-helpers"> <a href="#shortcut-helpers" class="anchor-heading" aria-labelledby="shortcut-helpers"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Shortcut helpers </h3> <p>There are some tasks that are repeated frequently, so the most reqular have shortcuts set up to make the rules more succinct.</p> <p>TODO - not clear how or where to use these!</p> <h4 id="syslog_mapping"> <a href="#syslog_mapping" class="anchor-heading" aria-labelledby="syslog_mapping"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">syslog_mapping</code> </h4> <p>Takes the syslog levels and maps them to console severities.</p> <ul> <li>This is a required field (TODO - what is?)</li> </ul> <h4 id="deduplicate"> <a href="#deduplicate" class="anchor-heading" aria-labelledby="deduplicate"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">deduplicate</code> </h4> <p>Shortcut for matching on <code class="language-plaintext highlighter-rouge">summary</code> with a regex and replacing it.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> - [ /match/, 'replace' ]
</code></pre></div></div> <p>Or supply a second regex if you want a more specific search replace</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> - [ /match/, /replace_match/, 'replace' ]
</code></pre></div></div> <ul> <li>A match will short-circuit dedupe execution, but continue on to any following rules.</li> </ul> <h4 id="discard--discard_last"> <a href="#discard--discard_last" class="anchor-heading" aria-labelledby="discard--discard_last"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">discard</code> / <code class="language-plaintext highlighter-rouge">discard_last</code> </h4> <p>Shortcuts for dumping messages, either before or after normal processing.</p> <p>Discard on summary:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  - '/trash/'
</code></pre></div></div> <p>Or write a full rule</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  - name: 'To the bin'
    match:
      summary: /trash/
</code></pre></div></div> <ul> <li>Discard will short-circuit execution.</li> </ul> <h3 id="selecting-events"> <a href="#selecting-events" class="anchor-heading" aria-labelledby="selecting-events"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Selecting Events </h3> <p>Rules need to be able to select an event to apply an action to.</p> <p>Multiple “select” options will combined into a logical “and” operation.</p> <p>Logical “or” operations can be achieved by:</p> <ul> <li>specifying an array of values for a “select” field</li> <li>using a regular expression <code class="language-plaintext highlighter-rouge">|</code> operator</li> <li>specifying an additional rule in the ruleset</li> </ul> <h4 id="match"> <a href="#match" class="anchor-heading" aria-labelledby="match"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">match</code> </h4> <p>Search a field for a match.</p> <p>When you supply <code class="language-plaintext highlighter-rouge">some string</code> the match becomes <code class="language-plaintext highlighter-rouge">/some string/</code> with any regex literals escaped:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>match:
  this_field: "some string"
</code></pre></div></div> <p>You can also speciy a regex directly with <code class="language-plaintext highlighter-rouge">js-yaml</code> type syntax</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>match:
  that_field: !!js/regexp /some \d+ digit/
</code></pre></div></div> <p>You can achieve a logical “or” by specifying an array of objects</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>match:
  other_field:
    - string search
    - !!js/regexp /regex search/
    - more
</code></pre></div></div> <h4 id="equals"> <a href="#equals" class="anchor-heading" aria-labelledby="equals"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">equals</code> </h4> <p>Exact match of the field <code class="language-plaintext highlighter-rouge">some_field</code> against the value <code class="language-plaintext highlighter-rouge">7</code>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>equals:
  some_field: 7
</code></pre></div></div> <p>You can achieve a logical “or” by specifying an array of values:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>match:
  other_field:
    - value
    - temp
    - over
</code></pre></div></div> <h4 id="field_exists"> <a href="#field_exists" class="anchor-heading" aria-labelledby="field_exists"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">field_exists</code> </h4> <p>Test for the existence of a field:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>field_exists: some_name_of_existing_field
</code></pre></div></div> <h4 id="field_missing"> <a href="#field_missing" class="anchor-heading" aria-labelledby="field_missing"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">field_missing</code> </h4> <p>Test whether a field is missing:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>field_missing: some_name_of_missing_field
</code></pre></div></div> <h4 id="starts_with"> <a href="#starts_with" class="anchor-heading" aria-labelledby="starts_with"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">starts_with</code> </h4> <p>Field starts with the string <code class="language-plaintext highlighter-rouge">Starting Text</code>. Like a regular expression <code class="language-plaintext highlighter-rouge">/^Starting Text/</code></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>starts_with
  a_field_name: 'Starting Text'
</code></pre></div></div> <h4 id="ends_with"> <a href="#ends_with" class="anchor-heading" aria-labelledby="ends_with"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">ends_with</code> </h4> <p>Field ends with the string <code class="language-plaintext highlighter-rouge">Ending Text</code>. Like a regular expression <code class="language-plaintext highlighter-rouge">/Ending Text$/</code></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ends_with
  a_field_name: 'Ending Text'
</code></pre></div></div> <h3 id="actions"> <a href="#actions" class="anchor-heading" aria-labelledby="actions"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Actions </h3> <h4 id="set"> <a href="#set" class="anchor-heading" aria-labelledby="set"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">set</code> </h4> <ul> <li> <p>Set a field to a value:</p> <ul> <li>name: super_set equals: node: ‘super.man.com’ set: group: ‘Krypton’</li> </ul> </li> <li> <p>Set a field by using the value from another field:</p> <ul> <li>name: prefix summary with node name set: summary: ‘{node} - {summary}’ match: summary: /hello world/</li> </ul> </li> <li> <p>Set a field using a paramaterized pattern match:</p> <ul> <li>name: change the words around set: summary: ‘{match.2} {match.1} number: {match.2}’ match: summary: /^(\w+) (\d+) (\w+).*/</li> </ul> </li> </ul> <h4 id="replace"> <a href="#replace" class="anchor-heading" aria-labelledby="replace"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">replace</code> </h4> <p>A field holding the value to be replaced must be specified using <code class="language-plaintext highlighter-rouge">field</code> and the value to be replaced using <code class="language-plaintext highlighter-rouge">this</code>. The new value must be specified using <code class="language-plaintext highlighter-rouge">with</code>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- name: other_replace
  match:
    summary: 'repeating repeating repeating'
  replace:
    field: message
    this: 'repeating'
    with: 'newrepeat'
</code></pre></div></div> <p>A warning will be logged if the replacement doesn’t find a match.</p> <h4 id="discard"> <a href="#discard" class="anchor-heading" aria-labelledby="discard"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">discard</code> </h4> <p>Sets the severity of the alert to -1, so that it will be discarded:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- name: other_replace
  match::
    node: 'spurious.alerts'
  discard: true
</code></pre></div></div> <p>TODO: is this incomplete? regex replace a value</p> <hr> <footer> <a href="https://openanswers.com/contact"> Contact</a> <img src="/sample-docs//img/oa2_square_gray_64x64.png"> <div class="d-flex mt-2"> <p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/vinceoa/sample-docs/tree/master/panther/rules/index.md" id="edit-this-page">Edit this page on GitHub.</a> </p> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
